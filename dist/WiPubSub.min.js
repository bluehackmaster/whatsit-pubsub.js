!function(n){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=n();else if("function"==typeof define&&define.amd)define([],n);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.WiPubSub=n()}}(function(){return function n(e,t,o){function i(u,f){if(!t[u]){if(!e[u]){var s="function"==typeof require&&require;if(!f&&s)return s(u,!0);if(r)return r(u,!0);var c=new Error("Cannot find module '"+u+"'");throw c.code="MODULE_NOT_FOUND",c}var l=t[u]={exports:{}};e[u][0].call(l.exports,function(n){var t=e[u][1][n];return i(t||n)},l,l.exports,n,e,t,o)}return t[u].exports}for(var r="function"==typeof require&&require,u=0;u<o.length;u++)i(o[u]);return i}({1:[function(n,e,t){"use strict";function o(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function n(n,e){for(var t=0;t<e.length;t++){var o=e[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(n,o.key,o)}}return function(e,t,o){return t&&n(e.prototype,t),o&&n(e,o),e}}(),r=n("mqtt"),u=n("bunyan"),f=u.createLogger({name:"WiPubSub"}),s=function(){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"whatsit-pubsub",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"mqtt";arguments.length>2&&void 0!==arguments[2]&&arguments[2];o(this,n),this.__url=t+"://"+e,this._this=this,this.onConnect=this.onConnect.bind(this),this.onError=this.onError.bind(this)}return i(n,[{key:"connect",value:function(){this.mqttClient=r.connect(this.__url),this.mqttClient.on("connect",this.onConnect),this.mqttClient.on("error",this.onError)}},{key:"isConnected",value:function(){return this.mqttClient.connected}},{key:"onConnect",value:function(){f.info("onConnect"),this.mqttClient.publish(this.topic,this.message),this.resolve()}},{key:"onError",value:function(n){f.info("onError: "+n),this.reject(n)}},{key:"publish",value:function(n,e){var t=this;return f.info("publish"),new Promise(function(o,i){t.resolve=o,t.reject=i,t.topic=n,t.message=e,t.connect()})}}]),n}();e.exports=s},{bunyan:void 0,mqtt:void 0}]},{},[1])(1)});
//# sourceMappingURL=WiPubSub.min.js.map
